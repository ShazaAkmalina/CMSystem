!function(a){"use strict";a.fn.gallery=function(b){return rs.modules.gallery.options!==b&&(b=a.extend({},rs.modules.gallery.options,b||{})),this.each(function(){var c={links:a(this)};c.preload=function(){c.links.each(function(){var c=a(this).addClass(b.className.galleryLoader),d=c.attr("href"),e=a('<img src="'+d+'" />');e.on("load",function(){c.removeClass(b.className.galleryLoader)})})},c.open=function(d,e){var f=d.attr("href"),g=a('<img src="'+f+'" />'),h="";c.data={counter:d.data("counter"),total:d.data("total"),artist:d.data("artist")||"",date:d.data("date")||"",description:d.data("description")||""},c.related=d.closest("ul"),b.loader&&c.container.addClass(b.className.galleryLoader),c.container.appendTo("body"),e||(c.overlay.appendTo("body"),rs.flags.modal=!0),g.addClass(b.className.galleryMedia).on("load",function(){clearTimeout(h),b.loader&&c.container.removeClass(b.className.galleryLoader),c.container.html(g),c.resize(),c.data.total>1&&c.createControl(),c.createMeta()}).on("click",function(a){a.stopPropagation()}),h=setTimeout(function(){c.close()},b.timeout)},c.resize=function(){var d=a(window),e=d.height(),f=d.width(),g=c.container.children("img"),h=g.data("height")||g.height(),i=g.data("width")||g.width(),j="",k="";g.data({height:h,width:i}),h>e&&(i=i*e*b.scaling/h,h=e*b.scaling),i>f&&(h=h*f*b.scaling/i,i=f*b.scaling),g.css({height:h,width:i}),j=c.container.outerHeight(),k=c.container.outerWidth(),c.container.css({"margin-top":-j/2,"margin-left":-k/2})},c.createControl=function(){c.buttonPrevious=a("<a>"+rs.language._gallery.image_previous+"</a>").addClass(b.className.controlPrevious).one("click",function(a){c.previous(),a.stopPropagation()}).appendTo(c.container),c.buttonNext=a("<a>"+rs.language._gallery.image_next+"</a>").addClass(b.className.controlNext).one("click",function(a){c.next(),a.stopPropagation()}).appendTo(c.container)},c.createMeta=function(){c.meta=a("<div>").addClass(b.className.galleryMeta),c.data.description&&(c.description=a('<div data-label="'+rs.language._gallery.image_description+'">'+c.data.description+"</div>").addClass(b.className.galleryDescription).appendTo(c.meta)),c.data.artist&&(c.artist=a('<div data-label="'+rs.language._gallery.image_artist+'">'+c.data.artist+"</div>").addClass(b.className.galleryArtist).appendTo(c.meta)),c.data.date&&(c.date=a('<div data-label="'+rs.language.date+'">'+c.data.date+"</div>").addClass(b.className.galleryDate).appendTo(c.meta)),c.data.total>1&&(c.pagination=a("<div>"+c.data.counter+rs.language._gallery.divider+c.data.total+"</div>").addClass(b.className.galleryPagination).appendTo(c.meta)),c.meta.appendTo(c.container)},c.listen=function(){c.links.on("click",function(b){var d=a(this);c.open(d),b.preventDefault()}),a(window).on("keydown",function(a){rs.flags.modal&&(27===a.which&&c.close(),37===a.which&&c.previous(),39===a.which&&c.next(),a.which>36&&a.which<41&&a.preventDefault())}).on("resize",function(){rs.flags.modal&&c.resize()}),c.overlay.on("click",function(){c.close()})},c.action=function(a){var b=c.related,d=c.data.counter,e="";"previous"===a?1===d?d=c.data.total:d--:"next"===a&&(d===c.data.total?d=1:d++),(d>1||d<c.data.total)&&(e=b.find('a[data-counter="'+d+'"]'),e.length&&(c.close(a),c.open(e,a)))},c.previous=function(){c.action("previous")},c.next=function(){c.action("next")},c.close=function(a){c.data={},c.container.empty().detach(),a||(c.overlay.detach(),rs.flags.modal=!1)},c.init=function(){c.data={},c.overlay=a("<div>").addClass(b.className.galleryOverlay),c.container=a("<div>").addClass(b.className.gallery),b.preload&&c.preload(),c.listen()},c.init()})},a(function(){rs.modules.gallery.init&&a(rs.modules.gallery.selector).gallery(rs.modules.gallery.options)})}(window.jQuery||window.Zepto);